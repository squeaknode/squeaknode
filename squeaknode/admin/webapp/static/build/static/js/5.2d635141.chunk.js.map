{"version":3,"sources":["components/Profile/index.js"],"names":["withRouter","props","useState","activeTab","setActiveTab","moreMenu","setMoreMenu","privateKey","setPrivateKey","editModalOpen","setEditModalOpen","changeImageModalOpen","setChangeImageModalOpen","deleteModalOpen","setDeleteModalOpen","exportModalOpen","setExportModalOpen","spendingModalOpen","setSpendingModalOpen","createModalOpen","setCreateModalOpen","tab","setTab","styleBody","setStyleBody","userParam","match","params","username","profileSqueaks","useSelector","selectProfileSqueaks","lastUserSqueak","selectLastProfileSqueak","profileSqueaksStatus","selectProfileSqueaksStatus","paymentSummary","selectPaymentSummaryForPubkey","user","selectCurrentProfile","dispatch","useDispatch","useEffect","window","scrollTo","fetchProfile","reloadSqueaks","fetchPaymentSummaryForPubkey","pubkey","isInitialMount","useRef","current","document","getElementsByTagName","style","cssText","changeTab","editProfile","values","setRenameProfile","profileId","getProfileId","profileName","name","toggleEditModal","deleteProfile","console","log","setDeleteProfile","toggleDeleteModal","exportPrivateKey","getProfilePrivateKey","then","unwrapResult","createContactProfile","setCreateContactProfile","toggleCreateModal","param","type","setTimeout","toggleChangeImageModal","toggleExportModal","toggleSpendingModal","handleModalClick","e","stopPropagation","uploadAvatar","file","reader","FileReader","addEventListener","imageBase64Stripped","result","split","uploadAvatarAsBase64","readAsDataURL","imageBase64","setProfileImage","clearProfileSqueaks","fetchProfileSqueaks","profilePubkey","limit","lastSqueak","openMore","AddContactProfileForm","onSubmit","className","class","label","placeholder","defaultValue","readOnly","disabled","fontSize","color","EditProfileForm","ChangeProfileImageForm","src","getProfileImageSrcString","alt","onChange","getElementById","files","changeAvatar","title","id","opacity","DeleteProfileForm","ExportPrivateKeyForm","initialValue","onClick","history","back","display","top","getBoundingClientRect","left","height","handleMenuClick","getHasPrivateKey","getFollowing","setUnfollowProfile","unfollowUser","setFollowProfile","followUser","getProfileName","getAmountSpentMsat","getAmountEarnedMsat","key","map","t","getReplyTo","squeak","getSqueakHash","getAuthor","getLikedTimeMs","length","squeakLst","slice","getMoreSqueaks"],"mappings":"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","file":"static/js/5.2d635141.chunk.js","sourcesContent":["import React , { useEffect, useState, useContext, useRef} from 'react'\r\nimport './style.scss'\r\nimport { ICON_ARROWBACK, ICON_MARKDOWN, ICON_DATE, ICON_CLOSE, ICON_UPLOAD, ICON_NEWMSG, ICON_SETTINGS, ICON_DARK } from '../../Icons'\r\nimport { withRouter, Link } from 'react-router-dom'\r\nimport { getProfileImageSrcString } from '../../squeakimages/images';\r\nimport Loader from '../Loader'\r\nimport moment from 'moment'\r\nimport SqueakCard from '../SqueakCard'\r\nimport {API_URL} from '../../config'\r\n\r\nimport { Form, Input, Select, Checkbox, Relevant, Debug, TextArea, Option } from 'informed';\r\n\r\n\r\nimport { unwrapResult } from '@reduxjs/toolkit'\r\nimport { useSelector } from 'react-redux'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport {\r\n  fetchProfile,\r\n  setFollowProfile,\r\n  setUnfollowProfile,\r\n  selectCurrentProfile,\r\n  setDeleteProfile,\r\n  setRenameProfile,\r\n  setCreateContactProfile,\r\n  setProfileImage,\r\n  setClearProfileImage,\r\n  getProfilePrivateKey,\r\n} from '../../features/profiles/profilesSlice'\r\nimport {\r\n  fetchProfileSqueaks,\r\n  selectProfileSqueaks,\r\n  selectLastProfileSqueak,\r\n  selectProfileSqueaksStatus,\r\n  clearProfileSqueaks,\r\n} from '../../features/squeaks/squeaksSlice'\r\nimport {\r\n  fetchPaymentSummaryForPubkey,\r\n  selectPaymentSummaryForPubkey,\r\n} from '../../features/payments/paymentsSlice'\r\n\r\nimport SentPayments from '../../features/payments/SentPayments'\r\nimport ReceivedPayments from '../../features/payments/ReceivedPayments'\r\n\r\n\r\n\r\nconst Profile = (props) => {\r\n  const [activeTab, setActiveTab] = useState('Squeaks')\r\n  const [moreMenu, setMoreMenu] = useState(false)\r\n  const [privateKey, setPrivateKey] = useState('')\r\n  const [editModalOpen, setEditModalOpen] = useState(false)\r\n  const [changeImageModalOpen, setChangeImageModalOpen] = useState(false)\r\n  const [deleteModalOpen, setDeleteModalOpen] = useState(false)\r\n  const [exportModalOpen, setExportModalOpen] = useState(false)\r\n  const [spendingModalOpen, setSpendingModalOpen] = useState(false)\r\n  const [createModalOpen, setCreateModalOpen] = useState(false)\r\n  const [tab, setTab] = useState('Sent Payments')\r\n  const [styleBody, setStyleBody] = useState(false)\r\n  const userParam = props.match.params.username\r\n\r\n  const profileSqueaks = useSelector(selectProfileSqueaks);\r\n  const lastUserSqueak = useSelector(selectLastProfileSqueak);\r\n  const profileSqueaksStatus = useSelector(selectProfileSqueaksStatus);\r\n  // const privateKey = 'TODO';\r\n  const paymentSummary = useSelector(selectPaymentSummaryForPubkey)\r\n\r\n  const user = useSelector(selectCurrentProfile);\r\n  const dispatch = useDispatch();\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0)\r\n    dispatch(fetchProfile(props.match.params.username));\r\n    reloadSqueaks();\r\n    dispatch(fetchPaymentSummaryForPubkey({pubkey: props.match.params.username}));\r\n    //preventing edit modal from apprearing after clicking a user on memOpen\r\n    setEditModalOpen(false);\r\n  }, [props.match.params.username])\r\n\r\n  const isInitialMount = useRef(true);\r\n  useEffect(() => {\r\n    if (isInitialMount.current){ isInitialMount.current = false }\r\n    else {\r\n      document.getElementsByTagName(\"body\")[0].style.cssText = styleBody && \"overflow-y: hidden; margin-right: 17px\"\r\n    }\r\n  }, [styleBody])\r\n\r\n  useEffect( () => () => document.getElementsByTagName(\"body\")[0].style.cssText = \"\", [] )\r\n\r\n  const changeTab = (tab) => {\r\n    setActiveTab(tab)\r\n  }\r\n\r\n  const editProfile = ({values}) => {\r\n    dispatch(setRenameProfile({\r\n      profileId: user.getProfileId(),\r\n      profileName: values.name,\r\n    }));\r\n    // TODO: chain action to update profile squeaks with the new name.\r\n    toggleEditModal()\r\n  }\r\n\r\n  const deleteProfile = () => {\r\n    let values = {\r\n      profileId: user.getProfileId(),\r\n    }\r\n    console.log('Delete user here');\r\n    dispatch(setDeleteProfile(values));\r\n    toggleDeleteModal();\r\n  }\r\n\r\n\r\n  const exportPrivateKey = () => {\r\n    dispatch(getProfilePrivateKey({\r\n      profileId: user.getProfileId(),\r\n    }))\r\n    .then(unwrapResult)\r\n    .then((privateKey) =>{\r\n      console.log(privateKey);\r\n      setPrivateKey(privateKey);\r\n    });\r\n  }\r\n\r\n  const createContactProfile = ({values}) => {\r\n    dispatch(setCreateContactProfile({\r\n      pubkey: userParam,\r\n      profileName: values.name,\r\n    }))\r\n    .then(() => {\r\n      dispatch(fetchProfile(props.match.params.username));\r\n    });\r\n    toggleCreateModal();\r\n  }\r\n\r\n  const toggleEditModal = (param, type) => {\r\n    setMoreMenu(false);\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setEditModalOpen(!editModalOpen) },20)\r\n  }\r\n\r\n  const toggleChangeImageModal = (param, type) => {\r\n    setMoreMenu(false);\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setChangeImageModalOpen(!changeImageModalOpen) },20)\r\n  }\r\n\r\n  const toggleDeleteModal = () => {\r\n    setMoreMenu(false);\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setDeleteModalOpen(!deleteModalOpen) },20)\r\n  }\r\n\r\n  const toggleExportModal = () => {\r\n    setMoreMenu(false);\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setExportModalOpen(!exportModalOpen) },20)\r\n  }\r\n\r\n  const toggleSpendingModal = (param, type) => {\r\n    setStyleBody(!styleBody)\r\n    if(type){setTab(type)}\r\n    if(type){setTab(type)}\r\n    setTimeout(()=>{ setSpendingModalOpen(!spendingModalOpen) },20)\r\n  }\r\n\r\n  const toggleCreateModal = (param, type) => {\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setCreateModalOpen(!createModalOpen) },20)\r\n  }\r\n\r\n  const handleModalClick = (e) => {\r\n    e.stopPropagation()\r\n  }\r\n\r\n  const followUser = (e,id) => {\r\n    e.stopPropagation()\r\n    dispatch(setFollowProfile(id));\r\n  }\r\n\r\n  const unfollowUser = (e,id) => {\r\n    console.log(e);\r\n    e.stopPropagation()\r\n    dispatch(setUnfollowProfile(id));\r\n  }\r\n\r\n  const changeAvatar = () => {\r\n    let file = document.getElementById('avatar').files[0];\r\n    uploadAvatar(file);\r\n    toggleChangeImageModal();\r\n  }\r\n\r\n  const clearAvatar = () => {\r\n    dispatch(setClearProfileImage({\r\n      profileId: user.getProfileId(),\r\n    }));\r\n  }\r\n\r\n  const uploadAvatar = (file) => {\r\n    if (file == null)\r\n    return;\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => {\r\n      // convert image file to base64 string\r\n      // preview.src = reader.result;\r\n      const imageBase64Stripped = reader.result.split(',')[1];\r\n      uploadAvatarAsBase64(imageBase64Stripped);\r\n    }, false);\r\n    if (file) {\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const uploadAvatarAsBase64 = (imageBase64) => {\r\n    dispatch(setProfileImage({\r\n      profileId: user.getProfileId(),\r\n      imageBase64: imageBase64,\r\n    }));\r\n  };\r\n\r\n  const getLastSqueak = (squeakLst) => {\r\n    if (squeakLst == null) {\r\n      return null;\r\n    } if (squeakLst.length === 0) {\r\n      return null;\r\n    }\r\n    return squeakLst.slice(-1)[0];\r\n  };\r\n\r\n  const getMoreSqueaks = () => {\r\n    let lastSqueak = getLastSqueak(profileSqueaks);\r\n    dispatch(fetchProfileSqueaks({\r\n      profilePubkey: props.match.params.username,\r\n      limit: 10,\r\n      lastSqueak: lastUserSqueak,\r\n    }));\r\n  }\r\n\r\n  const reloadSqueaks = () => {\r\n    dispatch(clearProfileSqueaks());\r\n    dispatch(fetchProfileSqueaks({\r\n      profilePubkey: props.match.params.username,\r\n      limit: 10,\r\n      lastSqueak: null,\r\n    }));\r\n  }\r\n\r\n  const openMore = () => { setMoreMenu(!moreMenu) }\r\n\r\n  const handleMenuClick = (e) => { e.stopPropagation() }\r\n\r\n\r\n  const AddContactProfileForm = () => (\r\n    <Form onSubmit={createContactProfile} className=\"Squeak-input-side\">\r\n      <div className=\"edit-input-wrap\">\r\n        <Input class=\"informed-input\" name=\"name\" label=\"Profile Name\" placeholder=\"Satoshi\" />\r\n      </div>\r\n      <div className=\"edit-input-wrap\">\r\n        <Input class=\"informed-input\" name=\"pubkey\" label=\"Public Key\" defaultValue={userParam} readOnly disabled />\r\n      </div>\r\n      <div className=\"inner-input-links\">\r\n        <div className=\"input-links-side\">\r\n        </div>\r\n        <div className=\"squeak-btn-holder\">\r\n          <div style={{ fontSize: '13px', color: null }}>\r\n          </div>\r\n          <button type=\"submit\" className={'squeak-btn-side squeak-btn-active'}>\r\n            Submit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Form>\r\n  );\r\n\r\n  const EditProfileForm = () => (\r\n    <Form onSubmit={editProfile} className=\"Squeak-input-side\">\r\n      <div className=\"edit-input-wrap\">\r\n        <Input class=\"informed-input\" name=\"name\" label=\"Profile Name\" placeholder=\"Satoshi\" />\r\n      </div>\r\n      <div className=\"inner-input-links\">\r\n        <div className=\"input-links-side\">\r\n        </div>\r\n        <div className=\"squeak-btn-holder\">\r\n          <div style={{ fontSize: '13px', color: null }}>\r\n          </div>\r\n          <button type=\"submit\" className={'squeak-btn-side squeak-btn-active'}>\r\n            Submit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Form>\r\n  );\r\n\r\n  const ChangeProfileImageForm = () => (\r\n    <Form onSubmit={uploadAvatar} className=\"Squeak-input-side\">\r\n      <div className=\"modal-profile-pic\">\r\n        <div className=\"modal-back-pic\">\r\n          <img src={user ? `${getProfileImageSrcString(user)}` : null} alt=\"profile\" />\r\n          <div>\r\n            <ICON_UPLOAD/>\r\n            <input onChange={()=>changeAvatar()} title=\" \" id=\"avatar\" style={{opacity:'0'}} type=\"file\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Form>\r\n  );\r\n\r\n\r\n  const DeleteProfileForm = () => (\r\n    <Form onSubmit={deleteProfile} className=\"Squeak-input-side\">\r\n      <div className=\"inner-input-links\">\r\n        <div className=\"input-links-side\">\r\n        </div>\r\n        <div className=\"squeak-btn-holder\">\r\n          <div style={{ fontSize: '13px', color: null }}>\r\n          </div>\r\n          <button type=\"submit\" className={'squeak-btn-side squeak-btn-active'}>\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Form>\r\n  );\r\n\r\n  const ExportPrivateKeyForm = () => (\r\n    <Form onSubmit={exportPrivateKey} className=\"Squeak-input-side\">\r\n      <div className=\"edit-input-wrap\">\r\n        <Input class=\"informed-input\" name=\"privateKey\" label=\"Display Private Key\" initialValue={privateKey} readOnly />\r\n      </div>\r\n      <div className=\"inner-input-links\">\r\n        <div className=\"input-links-side\">\r\n        </div>\r\n        <div className=\"squeak-btn-holder\">\r\n          <div style={{ fontSize: '13px', color: null }}>\r\n          </div>\r\n          <button type=\"submit\" className={'squeak-btn-side squeak-btn-active'}>\r\n            Export\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Form>\r\n  );\r\n\r\n  console.log(paymentSummary);\r\n\r\n  return(\r\n    <div>\r\n      <div>\r\n        <div className=\"profile-wrapper\">\r\n          <div className=\"profile-header-wrapper\">\r\n            <div className=\"profile-header-back\">\r\n              <div onClick={()=>window.history.back()} className=\"header-back-wrapper\">\r\n                <ICON_ARROWBACK/>\r\n              </div>\r\n            </div>\r\n            <div className=\"profile-header-content\">\r\n              <div className=\"profile-header-name\">\r\n                {userParam}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"profile-banner-wrapper\">\r\n            <img alt=\"\"/>\r\n          </div>\r\n          <div className=\"profile-details-wrapper\">\r\n            <div className=\"profile-options\">\r\n              <div className=\"profile-image-wrapper\">\r\n                <img src={user ? `${getProfileImageSrcString(user)}` : null} alt=\"\"/>\r\n              </div>\r\n\r\n              {user &&\r\n                <div id=\"profileMoreMenu\" onClick={openMore} className=\"Nav-link\">\r\n                  <div className={\"Nav-item-hover\"}>\r\n                    <ICON_SETTINGS  />\r\n                  </div>\r\n                  <div onClick={()=>openMore()} style={{display: moreMenu ? 'block' : 'none'}} className=\"more-menu-background\">\r\n                    <div className=\"more-modal-wrapper\">\r\n                      {moreMenu ?\r\n                        <div style={{\r\n                            top: document.getElementById('profileMoreMenu') && `${document.getElementById('profileMoreMenu').getBoundingClientRect().top - 40}px`,\r\n                            left: document.getElementById('profileMoreMenu') && `${document.getElementById('profileMoreMenu').getBoundingClientRect().left}px`,\r\n                            height: '210px',\r\n                          }} onClick={(e)=>handleMenuClick(e)} className=\"more-menu-content\">\r\n                          <div onClick={toggleEditModal} className=\"more-menu-item\">\r\n                            <span>Edit Profile</span>\r\n                          </div>\r\n                          <div onClick={toggleChangeImageModal} className=\"more-menu-item\">\r\n                            <span>Change Image</span>\r\n                          </div>\r\n                          {user.getHasPrivateKey() &&\r\n                            <div onClick={toggleExportModal} className=\"more-menu-item\">\r\n                              <span>Export Private Key</span>\r\n                            </div>\r\n                          }\r\n                          <div onClick={toggleDeleteModal} className=\"more-menu-item\">\r\n                            <span>Delete Profile</span>\r\n                          </div>\r\n                        </div> : null }\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                }\r\n\r\n                {user &&\r\n                  <div onClick={(e)=>\r\n                      user.getFollowing() ?\r\n                      unfollowUser(e,user.getProfileId()) :\r\n                      followUser(e,user.getProfileId())\r\n                    }\r\n                    className={user.getFollowing() ? 'unfollow-switch profile-edit-button' : 'profile-edit-button'}>\r\n                    <span><span>{ user.getFollowing() ? 'Following' : 'Follow'}</span></span>\r\n                  </div>\r\n                }\r\n\r\n                {!user &&\r\n                  <div onClick={(e)=>toggleCreateModal('create')}\r\n                    className='profiles-create-button'>\r\n                    <span>Add Contact Profile</span>\r\n                  </div>\r\n                }\r\n              </div>\r\n              <div className=\"profile-details-box\">\r\n                <div className=\"profile-name\">{user ? user.getProfileName() : ''}</div>\r\n                <div className=\"profile-username\">@{userParam}</div>\r\n                <div className=\"profile-info-box\">\r\n                  &nbsp;\r\n                </div>\r\n              </div>\r\n              <div className=\"profile-social-box\">\r\n                {/* TODO: Implement sats spent */}\r\n                <div onClick={()=>toggleSpendingModal('members','Sent Payments')}>\r\n                  <p className=\"follow-num\"> {paymentSummary && paymentSummary.getAmountSpentMsat() / 1000} </p>\r\n                  <p className=\"follow-text\"> sats spent </p>\r\n                </div>\r\n                {/* TODO: Implement sats eaned */}\r\n                <div onClick={()=>toggleSpendingModal('members', 'Received Payments')}>\r\n                  <p className=\"follow-num\"> {paymentSummary && paymentSummary.getAmountEarnedMsat() / 1000} </p>\r\n                  <p className=\"follow-text\"> sats earned </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"profile-nav-menu\">\r\n              <div key={'squeaks'} onClick={()=>changeTab('Squeaks')} className={activeTab ==='Squeaks' ? `profile-nav-item activeTab` : `profile-nav-item`}>\r\n                Squeaks\r\n              </div>\r\n              <div key={'replies'} onClick={()=>changeTab('Squeaks&Replies')} className={activeTab ==='Squeaks&Replies' ? `profile-nav-item activeTab` : `profile-nav-item`}>\r\n                Squeaks & replies\r\n              </div>\r\n              <div key={'liked'} onClick={()=>changeTab('Liked')} className={activeTab ==='Liked' ? `profile-nav-item activeTab` : `profile-nav-item`}>\r\n                Liked\r\n              </div>\r\n            </div>\r\n            {activeTab === 'Squeaks' ?\r\n              profileSqueaks.map(t=>{\r\n                if(!t.getReplyTo())\r\n                return <SqueakCard squeak={t} key={t.getSqueakHash()} id={t.getSqueakHash()} user={t.getAuthor()} />\r\n              }) :\r\n              activeTab === 'Squeaks&Replies' ?\r\n              profileSqueaks.map(t=>{\r\n                return <SqueakCard squeak={t} key={t.getSqueakHash()} id={t.getSqueakHash()} user={t.getAuthor()} />\r\n              }) :\r\n              activeTab === 'Liked' ?\r\n              profileSqueaks.map(t=>{\r\n                if(t.getLikedTimeMs())\r\n                return <SqueakCard squeak={t} key={t.getSqueakHash()} id={t.getSqueakHash()} user={t.getAuthor()} />\r\n              }) :\r\n              null}\r\n              {/* TODO: fix get loading state by doing this: https://medium.com/stashaway-engineering/react-redux-tips-better-way-to-handle-loading-flags-in-your-reducers-afda42a804c6 */}\r\n              {profileSqueaks.length > 0 &&\r\n                <>\r\n                {profileSqueaksStatus == 'loading' ?\r\n                  <Loader /> :\r\n                    <div onClick={() => getMoreSqueaks()} className='squeak-btn-side squeak-btn-active'>\r\n                      Load more\r\n                    </div>}\r\n                    </>\r\n                }\r\n\r\n              </div>\r\n\r\n              {/* Modal for edit profile */}\r\n              <div onClick={()=>toggleEditModal()} style={{display: editModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n                <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n                  <div className=\"modal-header\">\r\n                    <div className=\"modal-closeIcon\">\r\n                      <div onClick={()=>toggleEditModal()} className=\"modal-closeIcon-wrap\">\r\n                        <ICON_CLOSE />\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"modal-title\">Edit Profile</p>\r\n                  </div>\r\n                  <div className=\"modal-body\">\r\n                    <EditProfileForm />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Modal for change profile image */}\r\n              <div onClick={()=>toggleChangeImageModal()} style={{display: changeImageModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n                <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n                  <div className=\"modal-header\">\r\n                    <div className=\"modal-closeIcon\">\r\n                      <div onClick={()=>toggleChangeImageModal()} className=\"modal-closeIcon-wrap\">\r\n                        <ICON_CLOSE />\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"modal-title\">Change Profile Image</p>\r\n                  </div>\r\n                  <div className=\"modal-body\">\r\n                    <div className=\"modal-banner\">\r\n                    </div>\r\n                    <ChangeProfileImageForm />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n\r\n              {/* Modal for delete profile */}\r\n              <div onClick={()=>toggleDeleteModal()} style={{display: deleteModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n                <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n                  <div className=\"modal-header\">\r\n                    <div className=\"modal-closeIcon\">\r\n                      <div onClick={()=>toggleDeleteModal()} className=\"modal-closeIcon-wrap\">\r\n                        <ICON_CLOSE />\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"modal-title\">Delete Profile</p>\r\n                  </div>\r\n\r\n                  <div className=\"modal-body\">\r\n                    <DeleteProfileForm />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Modal for export profile */}\r\n              <div onClick={()=>toggleExportModal()} style={{display: exportModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n                <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n                  <div className=\"modal-header\">\r\n                    <div className=\"modal-closeIcon\">\r\n                      <div onClick={()=>toggleExportModal()} className=\"modal-closeIcon-wrap\">\r\n                        <ICON_CLOSE />\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"modal-title\">Export Private Key</p>\r\n                  </div>\r\n\r\n                  <div className=\"modal-body\">\r\n                    <ExportPrivateKeyForm />\r\n                  </div>\r\n\r\n                </div>\r\n              </div>\r\n\r\n\r\n              {/* Modal for sats spent and earned */}\r\n              <div onClick={()=>toggleSpendingModal()} style={{display: spendingModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n                <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n                  <div className=\"modal-header no-b-border\">\r\n                    <div className=\"modal-closeIcon\">\r\n                      <div onClick={()=>toggleSpendingModal()} className=\"modal-closeIcon-wrap\">\r\n                        <ICON_CLOSE />\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"modal-title\">{null}</p>\r\n                  </div>\r\n                  <div className=\"modal-body\">\r\n                    <div className=\"explore-nav-menu\">\r\n                      <div onClick={()=>setTab('Sent Payments')} className={tab =='Sent Payments' ? `explore-nav-item activeTab` : `explore-nav-item`}>\r\n                        Sent Payments\r\n                      </div>\r\n                      <div onClick={()=>setTab('Received Payments')} className={tab =='Received Payments' ? `explore-nav-item activeTab` : `explore-nav-item`}>\r\n                        Received Payments\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"modal-scroll\">\r\n                      {tab === 'Sent Payments' ?\r\n                        <>\r\n                        <SentPayments pubkey={props.match.params.username} />\r\n                        </>\r\n\r\n                      :\r\n                      tab === 'Received Payments' ?\r\n                      <>\r\n                      <ReceivedPayments pubkey={props.match.params.username} />\r\n                      </>\r\n                    : <div className=\"try-searching\">\r\n                    Nothing to see here ..\r\n                    <div/>\r\n                    Try searching for people, usernames, or keywords\r\n\r\n                  </div>\r\n                }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Modal for create contact profile */}\r\n        <div onClick={()=>toggleCreateModal()} style={{display: createModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n          <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <div className=\"modal-closeIcon\">\r\n                <div onClick={()=>toggleCreateModal()} className=\"modal-closeIcon-wrap\">\r\n                  <ICON_CLOSE />\r\n                </div>\r\n              </div>\r\n              <p className=\"modal-title\">Add Contact Profile</p>\r\n            </div>\r\n\r\n            <div className=\"modal-body\">\r\n              <AddContactProfileForm />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(Profile)\r\n"],"sourceRoot":""}