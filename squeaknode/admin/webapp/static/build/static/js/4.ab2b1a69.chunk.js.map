{"version":3,"sources":["components/Peer/index.js"],"names":["withRouter","props","useState","moreMenu","setMoreMenu","editName","setName","editModalOpen","setEditModalOpen","deleteModalOpen","setDeleteModalOpen","savePeerModalOpen","setSavePeerModalOpen","setSaved","styleBody","setStyleBody","peer","useSelector","selectCurrentPeer","dispatch","useDispatch","useEffect","window","scrollTo","fetchPeer","network","match","params","host","port","isInitialMount","useRef","current","document","getElementsByTagName","style","cssText","toggleEditModal","param","type","getPeerName","setTimeout","toggleDeleteModal","toggleSavePeerModal","handleModalClick","e","stopPropagation","openMore","className","onClick","history","back","id","display","top","getElementById","getBoundingClientRect","left","height","handleMenuClick","getAutoconnect","values","peerId","getPeerId","setPeerAutoconnectDisabled","disable","console","log","setPeerAutoconnectEnabled","enable","setDeletePeer","strippedHost","replace","setSavePeer","name","onChange","target","value","alert","defaultValue"],"mappings":"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","file":"static/js/4.ab2b1a69.chunk.js","sourcesContent":["import React , { useEffect, useState, useContext, useRef } from 'react'\r\nimport './style.scss'\r\nimport moment from 'moment'\r\nimport {  withRouter, Link } from 'react-router-dom'\r\nimport Loader from '../Loader'\r\nimport SqueakCard from '../SqueakCard'\r\nimport {API_URL} from '../../config'\r\nimport axios from 'axios'\r\nimport {ICON_ARROWBACK, ICON_UPLOAD, ICON_CLOSE,ICON_SEARCH, ICON_SETTINGS } from '../../Icons'\r\n\r\nimport { unwrapResult } from '@reduxjs/toolkit'\r\nimport { useSelector } from 'react-redux'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport {\r\n  fetchPeer,\r\n  selectCurrentPeer,\r\n  selectCurrentPeerStatus,\r\n  setSavePeer,\r\n  setDeletePeer,\r\n  setPeerAutoconnectEnabled,\r\n  setPeerAutoconnectDisabled,\r\n} from '../../features/peers/peersSlice'\r\n\r\n\r\nconst Peer = (props) => {\r\n\r\n  const [modalOpen, setModalOpen] = useState(false)\r\n  const [moreMenu, setMoreMenu] = useState(false)\r\n  const [editName, setName] = useState('')\r\n  const [editDescription, setDescription] = useState('')\r\n  const [editModalOpen, setEditModalOpen] = useState(false)\r\n  const [deleteModalOpen, setDeleteModalOpen] = useState(false)\r\n  const [savePeerModalOpen, setSavePeerModalOpen] = useState(false)\r\n  const [banner, setBanner] = useState('')\r\n  const [saved, setSaved] = useState(false)\r\n  const [tab, setTab] = useState('Members')\r\n  const [bannerLoading, setBannerLoading] = useState(false)\r\n  const [styleBody, setStyleBody] = useState(false)\r\n\r\n  const peer = useSelector(selectCurrentPeer);\r\n  const dispatch = useDispatch();\r\n\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0)\r\n    dispatch(fetchPeer({\r\n      network: props.match.params.network,\r\n      host: props.match.params.host,\r\n      port: props.match.params.port,\r\n    }));\r\n  }, [])\r\n\r\n  const isInitialMount = useRef(true);\r\n  useEffect(() => {\r\n    if (isInitialMount.current){ isInitialMount.current = false }\r\n    else {\r\n      document.getElementsByTagName(\"body\")[0].style.cssText = styleBody && \"overflow-y: hidden; margin-right: 17px\"\r\n    }\r\n  }, [styleBody])\r\n\r\n  useEffect( () => () => document.getElementsByTagName(\"body\")[0].style.cssText = \"\", [] )\r\n\r\n\r\n  const deletePeer = () => {\r\n    let values = {\r\n      peerId: peer.getPeerId(),\r\n    }\r\n    dispatch(setDeletePeer(values));\r\n    toggleDeleteModal();\r\n  }\r\n\r\n  function removeHttp(url) {\r\n    return url.replace(/^https?:\\/\\//, '');\r\n  }\r\n\r\n  const savePeer = () => {\r\n    const strippedHost = removeHttp(props.match.params.host);\r\n    dispatch(setSavePeer({\r\n      name: editName,\r\n      host: strippedHost,\r\n      port: props.match.params.port,\r\n      network: props.match.params.network,\r\n    }));\r\n    toggleSavePeerModal();\r\n  }\r\n\r\n  const enable = (e,id) => {\r\n    e.stopPropagation()\r\n    console.log(id);\r\n    console.log(peer.getPeerId());\r\n    let values = {\r\n      peerId: peer.getPeerId(),\r\n    }\r\n\r\n    dispatch(setPeerAutoconnectEnabled(values));\r\n  }\r\n\r\n  const disable = (e,id) => {\r\n    e.stopPropagation()\r\n    let values = {\r\n      peerId: peer.getPeerId(),\r\n    }\r\n    dispatch(setPeerAutoconnectDisabled(values));\r\n  }\r\n\r\n  const editPeer = () => {\r\n    let values = {\r\n      peerId: peer.getPeerId(),\r\n      name: editName,\r\n    }\r\n    // TODO: call rename action.\r\n    alert('Rename peer not yet implemented!');\r\n    // dispatch(setRenameProfile({\r\n    //   peerId: user.getPeerId(),\r\n    //   profileName: editName,\r\n    // }));\r\n    // TODO: chain action to update profile squeaks with the new name.\r\n    setSaved(true)\r\n    toggleEditModal()\r\n  }\r\n\r\n  const toggleEditModal = (param, type) => {\r\n    setStyleBody(!styleBody)\r\n    setSaved(false)\r\n    setName(peer.getPeerName())\r\n    setTimeout(()=>{ setEditModalOpen(!editModalOpen) },20)\r\n  }\r\n\r\n\r\n  const toggleDeleteModal = () => {\r\n    setStyleBody(!styleBody)\r\n    setSaved(false)\r\n    setTimeout(()=>{ setDeleteModalOpen(!deleteModalOpen) },20)\r\n  }\r\n\r\n  const toggleSavePeerModal = (param, type) => {\r\n    setStyleBody(!styleBody)\r\n    setTimeout(()=>{ setSavePeerModalOpen(!savePeerModalOpen) },20)\r\n  }\r\n\r\n  const handleModalClick = (e) => {\r\n    e.stopPropagation()\r\n  }\r\n\r\n  const openMore = () => { setMoreMenu(!moreMenu) }\r\n\r\n  const handleMenuClick = (e) => { e.stopPropagation() }\r\n\r\n\r\n  return(\r\n    <div>\r\n\r\n      <div className=\"profile-wrapper\">\r\n        <div className=\"profile-header-wrapper\">\r\n          <div className=\"profile-header-back\">\r\n            <div onClick={()=>window.history.back()} className=\"header-back-wrapper\">\r\n              <ICON_ARROWBACK/>\r\n            </div>\r\n          </div>\r\n          <div className=\"profile-header-content\">\r\n            <div className=\"profile-header-name\">\r\n              {props.match.params.host}:{props.match.params.port}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"profile-details-wrapper\">\r\n          <div className=\"profile-options\">\r\n\r\n            {peer &&\r\n              <div id=\"profileMoreMenu\" onClick={openMore} className=\"Nav-link\">\r\n                <div className={\"Nav-item-hover\"}>\r\n                  <ICON_SETTINGS  />\r\n                </div>\r\n                <div onClick={()=>openMore()} style={{display: moreMenu ? 'block' : 'none'}} className=\"more-menu-background\">\r\n                  <div className=\"more-modal-wrapper\">\r\n                    {moreMenu ?\r\n                      <div style={{\r\n                          top: document.getElementById('profileMoreMenu') && `${document.getElementById('profileMoreMenu').getBoundingClientRect().top - 40}px`,\r\n                          left: document.getElementById('profileMoreMenu') && `${document.getElementById('profileMoreMenu').getBoundingClientRect().left}px`,\r\n                          height: '210px',\r\n                        }} onClick={(e)=>handleMenuClick(e)} className=\"more-menu-content\">\r\n                        <div onClick={toggleDeleteModal} className=\"more-menu-item\">\r\n                          <span>Delete Profile</span>\r\n                        </div>\r\n                        <div onClick={toggleEditModal} className=\"more-menu-item\">\r\n                          <span>Edit Profile</span>\r\n                        </div>\r\n                      </div> : null }\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              }\r\n\r\n              {peer &&\r\n                <div onClick={(e)=>\r\n                    peer.getAutoconnect() ?\r\n                    disable(e,peer.getPeerId()) :\r\n                    enable(e,peer.getPeerId())\r\n                  }\r\n                  className={peer.getAutoconnect() ? 'enable-btn-wrap disable-switch' : 'enable-btn-wrap'}>\r\n                  <span><span>{ peer.getAutoconnect() ? 'Enabled' : 'Disabled'}</span></span>\r\n                </div>\r\n              }\r\n            </div>\r\n\r\n            <div className=\"profile-details-box\">\r\n              <div className=\"profile-name\">{peer && peer.getPeerName()}</div>\r\n              <div className=\"profile-username\">{props.match.params.host}:{props.match.params.port}</div>\r\n            </div>\r\n\r\n            <div className=\"profile-options\">\r\n              {!peer &&\r\n                <div onClick={(e)=>toggleSavePeerModal('edit')}\r\n                  className='profiles-create-button'>\r\n                  <span>Add Saved Peer</span>\r\n                </div>\r\n              }\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <div className=\"feed-wrapper\">\r\n            <div className=\"feed-trending-card\">\r\n              <div className=\"feed-card-trend\">\r\n                <div>Number of downloads</div>\r\n                <div>TODO</div>\r\n              </div>\r\n              <div className=\"feed-card-trend\">\r\n                <div>Number of purchases</div>\r\n                <div>TODO</div>\r\n              </div>\r\n              <div className=\"feed-card-trend\">\r\n                <div>Last connection time</div>\r\n                <div>TODO</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n\r\n        </div>\r\n\r\n        {/* Modal for delete peer */}\r\n        <div onClick={()=>toggleDeleteModal()} style={{display: deleteModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n          <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <div className=\"modal-closeIcon\">\r\n                <div onClick={()=>toggleDeleteModal()} className=\"modal-closeIcon-wrap\">\r\n                  <ICON_CLOSE />\r\n                </div>\r\n              </div>\r\n              <p className=\"modal-title\">'Delete Peer'</p>\r\n              <div className=\"save-modal-wrapper\">\r\n                <div onClick={deletePeer} className=\"save-modal-btn\">\r\n                  Delete\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Modal for create save peer */}\r\n        <div onClick={()=>toggleSavePeerModal()} style={{display: savePeerModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n          <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <div className=\"modal-closeIcon\">\r\n                <div onClick={()=>toggleSavePeerModal()} className=\"modal-closeIcon-wrap\">\r\n                  <ICON_CLOSE />\r\n                </div>\r\n              </div>\r\n              <p className=\"modal-title\">Save Peer</p>\r\n\r\n              <div className=\"save-modal-wrapper\">\r\n                <div onClick={savePeer} className=\"save-modal-btn\">\r\n                  Submit\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"modal-body\">\r\n              <form className=\"edit-form\">\r\n                <div className=\"edit-input-wrap\">\r\n                  <div className=\"edit-input-content\">\r\n                    <label>Name</label>\r\n                    <input onChange={(e)=>setName(e.target.value)} type=\"text\" name=\"name\" className=\"edit-input\"/>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n        {/* Modal for edit profile */}\r\n        <div onClick={()=>toggleEditModal()} style={{display: editModalOpen ? 'block' : 'none'}} className=\"modal-edit\">\r\n          <div onClick={(e)=>handleModalClick(e)} className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <div className=\"modal-closeIcon\">\r\n                <div onClick={()=>toggleEditModal()} className=\"modal-closeIcon-wrap\">\r\n                  <ICON_CLOSE />\r\n                </div>\r\n              </div>\r\n              <p className=\"modal-title\">'Edit Profile'</p>\r\n              <div className=\"save-modal-wrapper\">\r\n                <div onClick={editPeer} className=\"save-modal-btn\">\r\n                  Save\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"modal-body\">\r\n              {peer ?\r\n                <form className=\"edit-form\">\r\n                  <div className=\"edit-input-wrap\">\r\n                    <div className=\"edit-input-content\">\r\n                      <label>Name</label>\r\n                      <input defaultValue={peer.getPeerName()} onChange={(e)=>setName(e.target.value)} type=\"text\" name=\"name\" className=\"edit-input\"/>\r\n                    </div>\r\n                  </div>\r\n                </form> :\r\n                <form className=\"create-form\">\r\n                  <div className=\"create-input-wrap\">\r\n                    <div className=\"create-input-content\">\r\n                      <label>Name</label>\r\n                      <input defaultValue={''} onChange={(e)=>setName(e.target.value)} type=\"text\" name=\"name\" className=\"edit-input\"/>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n\r\n              }\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n  export default withRouter(Peer)\r\n"],"sourceRoot":""}